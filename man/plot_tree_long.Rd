% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_tree_long.R
\name{plot_tree_long}
\alias{plot_tree_long}
\title{Plot a phlyogenetic tree using the fan layout}
\usage{
plot_tree_long(
  tree_tbl,
  show_tiplab = TRUE,
  tiplab_size = 1,
  mrsd = NULL,
  linewidth = 0.5,
  highlight_var = NULL,
  heatmap_var = NULL,
  heatmap_colors = NULL,
  heatmap_offset = 0.15,
  heatmap_width = 5,
  heatmap_colnames_angle = 0,
  heatmap_colnames_font_size = 4,
  heatmap_colnames_hjust = 1,
  heatmap_colnames_vjust = 0,
  legend_show = NA,
  legend_breaks = list(),
  legend_guides = list(),
  legend_box = "horizontal",
  file_name = NULL,
  verbose = getOption("verbose")
)
}
\arguments{
\item{tree_tbl}{tibble; the phylogenetic tree in tibble format.}

\item{show_tiplab}{logical; show tip labels?}

\item{tiplab_size}{logical; text size for tiplabs.}

\item{mrsd}{tibble; the date of the most recent tip.}

\item{linewidth}{numeric; line width for the phylogenetic tree.}

\item{highlight_var}{character; a variable name used for highlighting tips.}

\item{heatmap_var}{character; a vector or variable names used for creating
heatmaps. If \code{NULL} the plot will not contain any heatmaps.}

\item{heatmap_colors}{list; a list of data frames used for color coding
heatmaps. See Details for more information. If \code{NULL}, the colors will
be generated automatically.}

\item{heatmap_offset}{numeric; distance between heatmaps.}

\item{heatmap_width}{numeric; width of a heatmap band.}

\item{heatmap_colnames_angle}{numeric; angle for column names.}

\item{heatmap_colnames_font_size}{numeric; font size for column names.}

\item{heatmap_colnames_hjust}{numeric; hjust for column names.}

\item{heatmap_colnames_vjust}{numeric; vjust for column names, down, from
bottom.}

\item{legend_show}{character; name of heatmap variables to include in legend.
By default, all variables are included.}

\item{legend_breaks}{list; a list of character vectors that tell which
levels to show on each heatmap. By default all levels will be shown for
each heatmap.}

\item{legend_guides}{list; a list of lists where the name of each list
element is the name of a legend we want to customize and the value is a list
of parameters that will be evaluated by guide_legend(). If left empty, the
legends will be drawn with defaults.}

\item{legend_box}{character; arrangement of multiple legends. Can be either
\code{"horizontal"} or \code{"vertical"}.}

\item{verbose}{logical; should verbose messages be printed to the console?}
}
\description{
This function plots a phylogenetic tree using the rectangular layout and
optionally adds a number of heatmaps.
}
\details{
When one or more heatmaps are added to the plot, it is possible to
define heatmap colors manually, using the \code{heatmap_colors} argument.
By default, the argument is \code{NULL} and the colors are defined
automatically. If the argument is not \code{NULL}, the function expects a
list of data frames, one data frame for each variable with manually defined
colors. The list elements must be named such that the name of the list
element matches the variable to which the colors belong.

. These data frames must contain a unique set of character levels and
corresponding color codes. The data frames must contain at least two columns:
one for the character levels, and one for the colors. The names of these
columns should be the name of the variable, and the \code{"color"},
respectively.
}
\examples{
\dontrun{
# manually define colors for the variable "mlst"
mlst_colors <- data.frame(
  mlst = c("ST1", "ST2, "Other"),
  color = c("red, "green", "grey50")
)
# plot the phylogenetic tree with manually defined colors
plot_tree_fan(
  tree_tbl,
  heatmap_var = "mlst",
  heatmap_colors = "mlst_colors"
)
}
}
