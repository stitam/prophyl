% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/root_rtt.R
\name{root_rtt}
\alias{root_rtt}
\title{Root a tree using root to tip distances}
\usage{
root_rtt(
  t,
  tip.dates,
  topx = 1,
  ncpu = 1,
  objective = NULL,
  objective_fn = NULL,
  opt.tol = .Machine$double.eps^0.25
)
}
\arguments{
\item{t}{phylo; a phylogentic tree.}

\item{tip.dates}{character; a vector of sampling times associated to the tips
of t, in the same order as t$tip.label.}

\item{ncpu}{integer; number of cores to use.}

\item{objective}{character; the name of the objective to use for finding the
best root. See Details for more information.}

\item{objective_fn}{function; either \code{NULL}, or a function that takes
two numeric vectors x then y, and returns a numeric value. This function will
be used to calculate the objective value for a given root. See Details for
more information.}

\item{opt.tol}{tolerance for optimization precision.}
}
\value{
The function returns a list of rooted phylogenetic trees.
}
\description{
This functions roots a phylogenetic tree using root to tip distances.
}
\details{
There are two ways to define an objective. The simplest approach is
to set \code{objective} to \code{"correlation"}, \code{"rsquared"}, or
\code{"rms"} and leave \code{objective_fn} as \code{NULL}. This way the
function will use built in functions for finding the best root position:
\itemize{
  \item \code{"correlation"}: look for the tree with the largest
    \code{cor.test(y, x)$estimate}
  \item \code{"rsquared"}: look for the tree with the largest
    \code{summary(lm(y ~ x))$r.squared}
  \item \code{"rms"}: look for the tree with the smallest
    \code{summary(lm(y ~ x))$sigma^2}
}

If none of these builtin objective functions are appropriate, you
can define a custom objective function in \code{objective_fn}. This function
must take two numeric vectors x then y and return a numeric value.
}
\note{
At the time of writing this documentation \code{ape::rtt()} cannot
handle missing dates, but \code{treedater:::.multi.rtt()} can. This
flexibility is preserved in \code{root_rtt()} as well.
}
\references{
Based on the non-exported \code{.multi.rtt()} function in the
\code{treedater} package.
https://github.com/emvolz/treedater/blob/master/R/multiRtT.R.

Based on the \code{rtt()} function in the \code{ape} package.
https://cran.r-project.org/web/packages/ape/index.html.
}
